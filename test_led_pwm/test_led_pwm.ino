/*************************************************** 
  This is an example for our Adafruit 16-channel PWM & Servo driver
  GPIO test - this will set a pin high/low

  Pick one up today in the adafruit shop!
  ------> http://www.adafruit.com/products/815

  These drivers use I2C to communicate, 2 pins are required to  
  interface.

  Adafruit invests time and resources providing this open source code, 
  please support Adafruit and open-source hardware by purchasing 
  products from Adafruit!

  Written by Limor Fried/Ladyada for Adafruit Industries.  
  BSD license, all text above must be included in any redistribution
 ****************************************************/

#include <Wire.h>
#include <Adafruit_PWMServoDriver.h>

// called this way, it uses the default address 0x20
//Adafruit_PWMServoDriver pwm = Adafruit_PWMServoDriver();
// you can also call it with a different address you want
Adafruit_PWMServoDriver pwm = Adafruit_PWMServoDriver(0x20);
// you can also call it with a different address and I2C interface
//Adafruit_PWMServoDriver pwm = Adafruit_PWMServoDriver(0x40, Wire);
int gamma[] = {
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  1,  1,  1,  1,  1,
    1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  2,  2,
    2,  2,  2,  2,  2,  2,  2,  2,  2,  3,  3,  3,  3,  3,  3,  3,
    3,  3,  3,  4,  4,  4,  4,  4,  4,  4,  5,  5,  5,  5,  5,  5,
    5,  6,  6,  6,  6,  6,  6,  7,  7,  7,  7,  7,  8,  8,  8,  8,
    8,  9,  9,  9,  9,  9, 10, 10, 10, 10, 11, 11, 11, 11, 12, 12,
   12, 12, 13, 13, 13, 13, 14, 14, 14, 15, 15, 15, 16, 16, 16, 17,
   17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22,
   23, 23, 23, 24, 24, 25, 25, 26, 26, 26, 27, 27, 28, 28, 29, 29,
   30, 30, 31, 31, 31, 32, 32, 33, 33, 34, 35, 35, 36, 36, 37, 37,
   38, 38, 39, 39, 40, 41, 41, 42, 42, 43, 43, 44, 45, 45, 46, 47,
   47, 48, 48, 49, 50, 50, 51, 52, 52, 53, 54, 55, 55, 56, 57, 57,
   58, 59, 60, 60, 61, 62, 63, 63, 64, 65, 66, 66, 67, 68, 69, 70,
   70, 71, 72, 73, 74, 75, 76, 76, 77, 78, 79, 80, 81, 82, 83, 84,
   84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99,
  100,101,102,103,104,105,106,107,109,110,111,112,113,114,115,116,
  117,119,120,121,122,123,124,126,127,128,129,130,132,133,134,135,
  137,138,139,140,142,143,144,146,147,148,150,151,152,154,155,156,
  158,159,160,162,163,165,166,168,169,170,172,173,175,176,178,179,
  181,182,184,185,187,188,190,192,193,195,196,198,199,201,203,204,
  206,208,209,211,213,214,216,218,219,221,223,224,226,228,230,231,
  233,235,237,239,240,242,244,246,248,250,251,253,255,257,259,261,
  263,265,267,269,270,272,274,276,278,280,282,284,286,288,290,293,
  295,297,299,301,303,305,307,309,311,314,316,318,320,322,324,327,
  329,331,333,335,338,340,342,344,347,349,351,354,356,358,361,363,
  365,368,370,373,375,377,380,382,385,387,390,392,395,397,400,402,
  405,407,410,412,415,417,420,423,425,428,430,433,436,438,441,444,
  446,449,452,454,457,460,463,465,468,471,474,477,479,482,485,488,
  491,494,497,499,502,505,508,511,514,517,520,523,526,529,532,535,
  538,541,544,547,550,553,556,560,563,566,569,572,575,578,582,585,
  588,591,594,598,601,604,607,611,614,617,621,624,627,631,634,638,
  641,644,648,651,655,658,661,665,668,672,675,679,683,686,690,693,
  697,700,704,708,711,715,719,722,726,730,733,737,741,744,748,752,
  756,759,763,767,771,775,779,782,786,790,794,798,802,806,810,814,
  818,822,826,830,834,838,842,846,850,854,858,862,866,870,875,879,
  883,887,891,895,900,904,908,912,917,921,925,930,934,938,943,947,
  951,956,960,965,969,973,978,982,987,991,996,1000,1005,1009,1014,1019,
  1023,1028,1032,1037,1042,1046,1051,1056,1060,1065,1070,1074,1079,1084,1089,1093,
  1098,1103,1108,1113,1118,1122,1127,1132,1137,1142,1147,1152,1157,1162,1167,1172,
  1177,1182,1187,1192,1197,1202,1207,1212,1218,1223,1228,1233,1238,1243,1249,1254,
  1259,1264,1270,1275,1280,1285,1291,1296,1301,1307,1312,1318,1323,1328,1334,1339,
  1345,1350,1356,1361,1367,1372,1378,1383,1389,1395,1400,1406,1412,1417,1423,1429,
  1434,1440,1446,1451,1457,1463,1469,1475,1480,1486,1492,1498,1504,1510,1516,1521,
  1527,1533,1539,1545,1551,1557,1563,1569,1575,1581,1588,1594,1600,1606,1612,1618,
  1624,1631,1637,1643,1649,1655,1662,1668,1674,1681,1687,1693,1700,1706,1712,1719,
  1725,1732,1738,1744,1751,1757,1764,1770,1777,1784,1790,1797,1803,1810,1817,1823,
  1830,1837,1843,1850,1857,1863,1870,1877,1884,1891,1897,1904,1911,1918,1925,1932,
  1939,1946,1953,1959,1966,1973,1980,1988,1995,2002,2009,2016,2023,2030,2037,2044,
  2051,2059,2066,2073,2080,2088,2095,2102,2109,2117,2124,2131,2139,2146,2154,2161,
  2168,2176,2183,2191,2198,2206,2213,2221,2228,2236,2244,2251,2259,2267,2274,2282,
  2290,2297,2305,2313,2321,2328,2336,2344,2352,2360,2367,2375,2383,2391,2399,2407,
  2415,2423,2431,2439,2447,2455,2463,2471,2479,2487,2496,2504,2512,2520,2528,2537,
  2545,2553,2561,2570,2578,2586,2595,2603,2611,2620,2628,2637,2645,2653,2662,2670,
  2679,2687,2696,2705,2713,2722,2730,2739,2748,2756,2765,2774,2783,2791,2800,2809,
  2818,2826,2835,2844,2853,2862,2871,2880,2889,2898,2907,2916,2925,2934,2943,2952,
  2961,2970,2979,2988,2997,3006,3016,3025,3034,3043,3053,3062,3071,3080,3090,3099,
  3108,3118,3127,3137,3146,3156,3165,3175,3184,3194,3203,3213,3222,3232,3242,3251,
  3261,3271,3280,3290,3300,3309,3319,3329,3339,3349,3359,3368,3378,3388,3398,3408,
  3418,3428,3438,3448,3458,3468,3478,3488,3498,3508,3519,3529,3539,3549,3559,3570,
  3580,3590,3601,3611,3621,3632,3642,3652,3663,3673,3684,3694,3705,3715,3726,3736,
  3747,3757,3768,3778,3789,3800,3810,3821,3832,3843,3853,3864,3875,3886,3897,3907,
  3918,3929,3940,3951,3962,3973,3984,3995,4006,4017,4028,4039,4050,4061,4073,4084,
  4095 };

void setup() {
  Serial.begin(115200);
  Serial.println("GPIO test!");

  pwm.begin();
  pwm.setPWMFreq(1000);  // Set to whatever you like, we don't use it in this demo!

  // if you want to really speed stuff up, you can go into 'fast 400khz I2C' mode
  // some i2c devices dont like this so much so if you're sharing the bus, watch
  // out for this!
  Wire.setClock(400000);
  for (uint8_t pin=0; pin<16; pin++) {
    pwm.setPWM(pin, 0, 0);       // turns pin fully on
    //delay(040);
   // pwm.setPWM(1, 0, val);       // turns pin fully off
  }

  

}

void loop() {
  // Drive each pin in a 'wave'
  for (int val=0; val<1024; val++) {
    pwm.setPWM(3, 0, (gamma[val]));       // turns pin fully on
    delay(010);
    pwm.setPWM(4, 0, val*4);       // turns pin fully off
    Serial.println(val);
  }
}
